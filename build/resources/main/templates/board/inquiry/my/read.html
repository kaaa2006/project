<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>문의 상세</title>

    <!-- 전역 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/tokens.css?v=2}">
    <link rel="stylesheet" th:href="@{/css/components.css?v=2}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9.4.1/swiper-bundle.min.css">
    <link rel="stylesheet" th:href="@{/css/header.css?v=20250821}">

    <!-- 기존 사용자 전용 CSS -->
    <link rel="stylesheet" th:href="@{/css/pages/user.css}">

    <!-- ✅ 문의 상세 전용(디자인 전용) -->
    <link rel="stylesheet" th:href="@{/css/pages/inquiryUserRead.css?v=1}">

    <!-- Favicon -->
    <link rel="icon" th:href="@{/favicon.ico}">

    <!-- CSRF for AJAX (user.js에서 사용) -->
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
</head>
<body class="inquiry-user-read">

<!-- 공통 헤더 -->
<header th:replace="~{fragments/header :: header}"></header>

<main class="list-container">
    <!-- 타이틀 -->
    <h1 class="page-title">문의 상세</h1>

    <!-- 문의 내용 카드 -->
    <section class="pf-card">
        <div class="pf-card-head">
            <div class="pf-card-title">내 문의</div>
            <div class="meta">
                <span>작성자: <strong th:text="${dto.userName}">홍길동</strong></span>
                <span>작성일: <span th:text="${#temporals.format(dto.regDate,'yyyy-MM-dd a h:mm')}">-</span></span>
            </div>
        </div>
        <div class="pf-card-body">
            <!-- 제목 -->
            <h2 id="titleDisplay"
                th:attr="data-id=${dto.id}"
                th:text="${dto.title}"
                class="post-title">
                문의 제목
            </h2>

            <!-- 내용 (개행 보존) -->
            <div id="contentDisplay"
                 class="post-content"
                 th:utext="${#strings.escapeXml(dto.content)?.replaceAll('\n','<br/>')}">
                문의 내용
            </div>
        </div>
    </section>

    <!-- 관리자 답변 카드 -->
    <section class="pf-card">
        <div class="pf-card-head">
            <div class="pf-card-title">관리자 답변</div>
            <div class="meta">
                <span>작성자: <strong>관리자</strong></span>
                <span>답변일: <span th:text="${#temporals.format(dto.answerDate,'yyyy-MM-dd a h:mm')}">-</span></span>
            </div>
        </div>
        <div class="pf-card-body">
            <!-- 답변 있음 -->
            <div th:if="${dto.answerContent != null}" class="answer-view alert">
                <p th:text="${dto.answerContent}">답변 내용</p>
            </div>

            <!-- 답변 없음 -->
            <div th:if="${dto.answerContent == null}" class="answer-empty alert alert-secondary">
                <p>아직 답변이 등록되지 않았습니다.</p>
            </div>
        </div>
    </section>

    <!-- 하단 액션 -->
    <div class="bottom-actions">
        <a th:href="@{/inquiry/my/list}" class="btn-outline">목록으로</a>

        <div class="right">
            <!-- 수정 버튼 (user.js가 클릭 핸들링) -->
            <button id="editInquiryBtn" class="btn-primary btn-sm">수정</button>

            <!-- 삭제 버튼 (form 그대로 유지) -->
            <form th:action="@{'/inquiry/my/' + ${dto.id}}"
                  method="post"
                  style="display:inline">
                <input type="hidden" name="_method" value="delete" />
                <button id="deleteInquiryBtn" type="button" class="btn btn-danger btn-sm">삭제</button>
            </form>
        </div>
    </div>
</main>

<!-- 기존 JS 그대로 -->
<script th:src="@{/js/user.js}" defer></script>

<!-- 공통 푸터 -->
<footer th:replace="~{fragments/footer :: footer}"></footer>

<!-- 전역 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@9.4.1/swiper-bundle.min.js"></script>
<script th:src="@{/js/main.js}" defer></script>
</body>
</html>
