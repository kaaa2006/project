<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">
<head>
    <title>회원가입</title>
    <!-- (A) 페이지 전용 CSS -->
    <th:block layout:fragment="page_head">
        <link rel="stylesheet" th:href="@{/css/pages/signup-form.css}">
    </th:block>
</head>
<body>
<div layout:fragment="content" class="container-xxl signup-page">
    <div class="signup-wrap">
        <h2 class="signup-title">회원가입</h2>
        <div class="signup-step">회원정보를 입력해주세요.</div>

        <!-- 서버 전역 에러 -->
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

        <div class="signup-card">
            <div class="signup-card-head">
                <div class="section-title">기본정보</div>
                <div class="help-legend">• 표시는 반드시 입력해야 하는 항목입니다.</div>
            </div>

            <form id="signupForm" th:action="@{/members/join}" method="post" th:object="${memberJoinDTO}" novalidate>
                <!-- CSRF -->
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                <!-- DTO 바인딩용: 최종 이메일 -->
                <input type="hidden" id="emailFull" th:field="*{email}">

                <!-- 이메일 (아이디) -->
                <div class="mb-3">
                    <label class="form-label">• 이메일 (아이디)</label>
                    <div class="email-grid">
                        <input id="emailLocal" type="text" class="form-control" placeholder="아이디" required autocomplete="email">
                        <div class="at-badge">@</div>
                        <input id="emailDomain" type="text" class="form-control" placeholder="example.com" required>
                        <select id="emailDomainSel" class="form-select">
                            <option value="">직접입력</option>
                            <option>naver.com</option>
                            <option>gmail.com</option>
                            <option>kakao.com</option>
                            <option>daum.net</option>
                            <option>hanmail.net</option>
                        </select>
                        <!-- [추가] 이메일 중복확인 -->
                        <button id="btnEmailCheck" type="button" class="btn btn-outline-secondary">중복확인</button>
                    </div>
                    <div id="emailHint" class="hint"></div>
                    <div class="field-error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">이메일 오류</div>
                </div>

                <!-- 비밀번호 / 확인 -->
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">• 비밀번호</label>
                        <input id="pw" type="password" th:field="*{password}" class="form-control"
                               minlength="8" maxlength="64" placeholder="8자 이상 입력" required autocomplete="new-password">
                        <div id="pwHint" class="hint danger">비밀번호를 8자 이상 입력.</div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">• 비밀번호 확인</label>
                        <input id="pw2" type="password" th:field="*{confirmPassword}" class="form-control"
                               minlength="8" maxlength="64" required autocomplete="new-password">
                        <div id="pw2Hint" class="hint danger">비밀번호를 확인해주세요.</div>
                    </div>
                </div>

                <!-- 이름 / 휴대폰 -->
                <div class="row g-3 mt-1">
                    <div class="col-md-6">
                        <label class="form-label">• 이름</label>
                        <input type="text" th:field="*{memberName}" class="form-control" maxlength="20" required autocomplete="name">
                        <div class="field-error" th:if="${#fields.hasErrors('memberName')}" th:errors="*{memberName}">이름 오류</div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">• 휴대폰번호</label>
                        <div class="input-group">
                            <input type="text" th:field="*{phone}" class="form-control"
                                   placeholder="- 없이 입력하세요." maxlength="13" inputmode="numeric" pattern="^[0-9]{9,13}$" required>
                            <!-- [요청] 인증번호 버튼은 UI만 -->
                            <button type="button" class="btn btn-outline-secondary" disabled title="준비 중">인증번호받기</button>
                        </div>
                        <div class="field-error" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}">휴대폰 오류</div>
                    </div>
                </div>

                <!-- 약관 -->
                <div class="terms-box">
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" id="agreeAll">
                        <label class="form-check-label fw-semibold" for="agreeAll">모든 약관 전체 동의</label>
                    </div>

                    <div class="ps-4 vstack gap-2">
                        <!-- [요청] 필수 약관은 DTO/엔티티 바인딩 없이 required만 -->
                        <div class="form-check">
                            <input class="form-check-input req-term agree-item" type="checkbox" id="agreeTerms" required>
                            <label class="form-check-label" for="agreeTerms">[필수] 이용약관 동의</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input req-term agree-item" type="checkbox" id="agreePrivacy" required>
                            <label class="form-check-label" for="agreePrivacy">[필수] 개인정보 처리방침 동의</label>
                        </div>
                        <!-- (선택) 마케팅 수신 동의: DTO 바인딩 + 라벨에 (SMS, 이메일) 표기만 -->
                        <div class="form-check">
                            <input class="form-check-input agree-item" type="checkbox" th:field="*{marketingYn}" id="mk">
                            <label class="form-check-label" for="mk">[선택] 정보 수신 동의 <span class="text-muted">(SMS, 이메일)</span></label>
                        </div>
                    </div>
                </div>

                <button class="btn btn-teal w-100 mt-3" type="submit">가입하기</button>
            </form>
        </div>
    </div>
</div>

<!-- (B) 페이지 전용 JS -->
<th:block layout:fragment="page_foot">
    <script th:src="@{/js/signup-form.js}"></script>
</th:block>
</body>
</html>
